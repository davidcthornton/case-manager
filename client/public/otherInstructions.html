<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Other Device Collection Instructions</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #f0f0f0;
      --card-bg: #fff;
      --accent: #007BFF;
      --muted: #6c757d;
      --shadow: 0 4px 10px rgba(0,0,0,0.1);
      --radius-lg: 1rem;
    }
    html, body { height: 100%; margin: 0; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: #111;
    }
    .page {
      min-height: 100vh; display: flex; flex-direction: column;
      justify-content: center; align-items: center; padding: 2rem; box-sizing: border-box; gap: 1rem;
    }
    .card {
      background: var(--card-bg); border-radius: var(--radius-lg); box-shadow: var(--shadow);
      padding: 2rem; width: 80%; max-width: 600px; text-align: left;
    }
    .index { margin-bottom: 1rem; font-weight: bold; }
    .nav { display: flex; justify-content: center; gap: 1rem; margin-top: 1rem; flex-wrap: wrap; }
    .btn {
      margin-top: 1.5rem; padding: 0.75rem 1.5rem; font-size: 1rem;
      border-radius: 0.5rem; border: none; cursor: pointer;
    }
    .btn-primary { background: var(--accent); color: #fff; }
    .btn-muted { background: var(--muted); color: #fff; }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }
    noscript { color: #b00020; }
  </style>
</head>
<body>
  <div class="page" id="page">
    <div class="card">
      <div class="index" id="idx">1/3</div>
      <h2 id="title">Loading…</h2>
      <div id="content">Please wait…</div>
      <noscript>This page requires JavaScript to display the instructions.</noscript>
    </div>

    <div class="nav">
      <button class="btn btn-muted" id="prevBtn">◀️ Previous</button>
      <button class="btn btn-muted" id="nextBtn">Next ▶️</button>
    </div>

    <button class="btn btn-primary" id="doneBtn">Done</button>
  </div>

  <script>
    (function () {
      function init() {
        // Content based on your React OtherInstructions component. :contentReference[oaicite:2]{index=2}
        var cards = [
          {
            title: 'Document Device and Procedures',
            html:
              '<ul>' +
                '<li>Photograph</li>' +
                '<li>Video</li>' +
                '<li>Sketch</li>' +
                '<li>Notes</li>' +
                '<li>Chain of custody</li>' +
              '</ul>'
          },
          {
            title: 'Collection and Packaging',
            html:
              '<div>' +
                '<p>If available, static-free evidence bags are best for the storage of media.</p>' +
                '<p>Work with crime scene service technicians or trained forensic personnel to preserve forensic evidence (fingerprints, biological samples, DNA, etc.) without disturbing the integrity of the device.</p>' +
              '</div>'
          },
          {
            title: 'Transport',
            html:
              '<div>' +
                '<p>Deliver evidence to a secure law enforcement facility or digital evidence laboratory as soon as possible.</p>' +
                '<p>Protect the device from temperature extremes and moisture.</p>' +
                '<p>Package evidence so it will not be physically damaged or deformed.</p>' +
              '</div>'
          }
        ];

        var idxEl = document.getElementById('idx');
        var titleEl = document.getElementById('title');
        var contentEl = document.getElementById('content');
        var prevBtn = document.getElementById('prevBtn');
        var nextBtn = document.getElementById('nextBtn');
        var doneBtn = document.getElementById('doneBtn');
        var page = document.getElementById('page');

        if (!idxEl || !titleEl || !contentEl) return;

        var index = 0;

        function render() {
          var total = cards.length;
          var card = cards[index];
          idxEl.textContent = (index + 1) + "/" + total;   // no template literals
          titleEl.textContent = card.title;
          contentEl.innerHTML = card.html;
          prevBtn.disabled = (index === 0);
          nextBtn.disabled = (index === total - 1);
        }

        prevBtn.addEventListener('click', function () {
          index = Math.max(0, index - 1);
          render();
        });

        nextBtn.addEventListener('click', function () {
          index = Math.min(cards.length - 1, index + 1);
          render();
        });

        function finish() {
          window.close();
          // Fallback: notify opener so it can close/cleanup if needed
          try {
            if (window.opener && !window.opener.closed) {
              window.opener.postMessage({ type: 'instructionDone', source: 'other' }, window.location.origin);
            }
          } catch (e) {}
        }

        doneBtn.addEventListener('click', finish);

        window.addEventListener('keydown', function (e) {
          if (e.key === 'ArrowLeft') prevBtn.click();
          else if (e.key === 'ArrowRight') nextBtn.click();
          else if (e.key === 'Escape') finish();
        });

        // simple swipe support
        var startX = null, isMouseDown = false;
        function start(x) { startX = x; }
        function end(x) {
          if (startX == null || x == null) return;
          var dx = x - startX, T = 50;
          if (dx <= -T) nextBtn.click();
          if (dx >=  T) prevBtn.click();
          startX = null;
        }
        page.addEventListener('touchstart', function (e) { start(e.touches[0].clientX); }, { passive: true });
        page.addEventListener('touchend', function (e) {
          var t = e.changedTouches && e.changedTouches[0];
          end(t ? t.clientX : null);
        });
        page.addEventListener('mousedown', function (e) { isMouseDown = true; start(e.clientX); });
        page.addEventListener('mouseup', function (e) { if (isMouseDown) end(e.clientX); isMouseDown = false; });
        page.addEventListener('mouseleave', function () { isMouseDown = false; startX = null; });

        render();
      }

      if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
      else init();
    })();
  </script>
</body>
</html>
